(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fccc"],{b4bf:function(t,e,a){"use strict";a.r(e);var o=a("7a23"),n={class:"py-4"},c=Object(o["g"])("h2",{class:"text-center"},"優惠券管理",-1),l={class:"d-flex justify-content-end"},d={class:"table table-hover"},s=Object(o["g"])("thead",null,[Object(o["g"])("tr",null,[Object(o["g"])("th",{width:"25%"},"優惠券名稱"),Object(o["g"])("th",{width:"10%"},"優惠內容"),Object(o["g"])("th",{width:"15%"},"優惠券到期日"),Object(o["g"])("th",{width:"15%"},"是否啟用"),Object(o["g"])("th",{width:"25%"},"操作")])],-1),i=Object(o["g"])("span",{class:"btnInside"},null,-1),u={class:"isEnabled"},r={key:0,class:"loading"},b=Object(o["g"])("div",{class:"loadIcon spinner-border",role:"status"},[Object(o["g"])("span",{class:"visually-hidden"},"Loading...")],-1);function p(t,e,a,p,m,g){var h=Object(o["x"])("pagination"),j=Object(o["x"])("couponModal"),O=Object(o["x"])("deleteModal");return Object(o["s"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("div",n,[c,Object(o["g"])("div",l,[Object(o["g"])("button",{type:"button",class:"btn btn-primary mb-3",onClick:e[1]||(e[1]=function(t){return g.openModal("addCoupon")})},"建立優惠券")]),Object(o["g"])("table",d,[s,Object(o["g"])("tbody",null,[(Object(o["s"])(!0),Object(o["d"])(o["a"],null,Object(o["w"])(m.coupons,(function(t){return Object(o["s"])(),Object(o["d"])("tr",{class:"align-middle",key:t.id},[Object(o["g"])("td",null,Object(o["A"])(t.title),1),Object(o["g"])("td",null,Object(o["A"])(t.percent)+"%",1),Object(o["g"])("td",null,Object(o["A"])(t.due_date_string),1),Object(o["g"])("td",null,[Object(o["g"])("input",{type:"checkbox",class:"checkbox",id:t.id,onChange:function(e){return g.changeStatus(t.is_enabled,t)},checked:1===t.is_enabled},null,40,["id","onChange","checked"]),Object(o["g"])("label",{for:t.id,class:"btnWrap"},[i],8,["for"]),Object(o["g"])("span",u,Object(o["A"])(1===t.is_enabled?"啟用":"不啟用"),1)]),Object(o["g"])("td",null,[Object(o["g"])("button",{type:"button",class:"btn btn-primary me-2",onClick:function(e){return g.openModal("editCoupon",t)}},"編輯",8,["onClick"]),Object(o["g"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(e){return g.openModal("deleteCoupon",t)}}," 刪除",8,["onClick"])])])})),128))])]),Object(o["g"])(h,{paginationData:m.pagination,onGetData:g.getCouponData},null,8,["paginationData","onGetData"])]),m.getCouponLoading?(Object(o["s"])(),Object(o["d"])("div",r,[b])):Object(o["e"])("",!0),Object(o["g"])(j,{ref:"couponModal",onGetCouponsData:g.getCouponData},null,8,["onGetCouponsData"]),Object(o["g"])(O,{ref:"deleteModal",onGetCouponsData:g.getCouponData},null,8,["onGetCouponsData"])],64)}var m=a("5530"),g=(a("99af"),{ref:"modal",class:"modal fade",tabindex:"-1"}),h={class:"modal-dialog"},j={class:"modal-content"},O={class:"modal-header bg-dark text-white"},f=Object(o["g"])("h5",{class:"modal-title"},"優惠券建立",-1),v={class:"modal-body"},C={class:"formGroup mb-3"},D=Object(o["g"])("label",{for:"title",class:"form-label"},"優惠券名稱",-1),M={class:"formGroup mb-3"},y=Object(o["g"])("label",{for:"percent",class:"form-label"},"優惠券折扣數",-1),_={class:"formGroup mb-3"},k=Object(o["g"])("label",{for:"code",class:"form-label"},"優惠代碼",-1),x={class:"formGroup mb-3"},w=Object(o["g"])("label",{for:"due_date",class:"form-label"},"到期日",-1),$={key:0,class:"formGroup mb-3"},V=Object(o["g"])("label",{for:"is_enabled"},"是否啟用",-1),G={class:"modal-footer"},F={key:0,type:"submit",class:"btn btn-primary"},E={key:1,type:"submit",class:"btn btn-primary"};function L(t,e,a,n,c,l){var d=Object(o["x"])("Field"),s=Object(o["x"])("ErrorMessage"),i=Object(o["x"])("Form");return Object(o["s"])(),Object(o["d"])("div",g,[Object(o["g"])("div",h,[Object(o["g"])("div",j,[Object(o["g"])(i,{onSubmit:e[8]||(e[8]=function(t){return l.postCoupon(c.modal)}),key:c.clearForm},{default:Object(o["F"])((function(t){var a=t.errors;return[Object(o["g"])("div",O,[f,Object(o["g"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return l.closeModal&&l.closeModal.apply(l,arguments)})})]),Object(o["g"])("div",v,[Object(o["g"])("div",C,[D,Object(o["g"])(d,{type:"text",class:["form-control",{"is-invalid":a["優惠券名稱"]}],id:"title",name:"優惠券名稱",placeholder:"請輸入優惠券名稱",rules:"required",modelValue:c.tempData.title,"onUpdate:modelValue":e[2]||(e[2]=function(t){return c.tempData.title=t})},null,8,["class","modelValue"]),Object(o["g"])(s,{name:"優惠券名稱",class:"invalid-feedback"})]),Object(o["g"])("div",M,[y,Object(o["g"])(d,{type:"number",class:["form-control",{"is-invalid":a["優惠券折扣數"]}],id:"percent",name:"優惠券折扣數",placeholder:"請輸入優惠券折扣數(單位為%)",rules:l.percentRule,min:"0",modelValue:c.tempData.percent,"onUpdate:modelValue":e[3]||(e[3]=function(t){return c.tempData.percent=t}),modelModifiers:{number:!0}},null,8,["class","rules","modelValue"]),Object(o["g"])(s,{name:"優惠券折扣數",class:"invalid-feedback"})]),Object(o["g"])("div",_,[k,Object(o["g"])(d,{type:"text",class:["form-control",{"is-invalid":a["優惠代碼"]}],id:"code",name:"優惠代碼",placeholder:"請輸入優惠代碼",rules:"required",modelValue:c.tempData.code,"onUpdate:modelValue":e[4]||(e[4]=function(t){return c.tempData.code=t})},null,8,["class","modelValue"]),Object(o["g"])(s,{name:"優惠代碼",class:"invalid-feedback"})]),Object(o["g"])("div",x,[w,Object(o["g"])(d,{type:"date",class:["form-control",{"is-invalid":a["到期日"]}],id:"due_date",name:"到期日",placeholder:"請輸入到期日",rules:"required",modelValue:c.tempData.due_date_string,"onUpdate:modelValue":e[5]||(e[5]=function(t){return c.tempData.due_date_string=t})},null,8,["class","modelValue"]),Object(o["g"])(s,{name:"到期日",class:"invalid-feedback"})]),"addCoupon"===c.modal?(Object(o["s"])(),Object(o["d"])("div",$,[Object(o["g"])("input",{type:"checkbox",id:"is_enabled",name:"is_enabled",onChange:e[6]||(e[6]=function(){return l.isEnabled&&l.isEnabled.apply(l,arguments)})},null,32),V])):Object(o["e"])("",!0)]),Object(o["g"])("div",G,[Object(o["g"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[7]||(e[7]=function(){return l.closeModal&&l.closeModal.apply(l,arguments)})},"取消"),"addCoupon"===c.modal?(Object(o["s"])(),Object(o["d"])("button",F,"建立")):(Object(o["s"])(),Object(o["d"])("button",E,"編輯"))])]})),_:1})])])],512)}var A=a("7b17"),U=a("1940"),q=a.n(U),S={data:function(){return{couponModal:{},modal:"",tempData:{title:"",percent:"",due_date_string:"",code:"",is_enabled:0},clearForm:!1}},methods:{openModal:function(){this.clearForm=!1,this.couponModal.show()},closeModal:function(){this.clearForm=!0,this.clearData(),this.modal="",this.couponModal.hide()},clearData:function(){this.tempData={title:"",percent:"",due_date_string:"",code:"",is_enabled:0}},percentRule:function(t){return t?t>=100?"優惠券折扣數 必須小於100":!(t<=0)||"優惠券折扣數 不得小於等於0":"優惠券折扣數 為必填欄位"},isEnabled:function(){this.tempData.is_enabled?this.tempData.is_enabled=0:this.tempData.is_enabled=1},postCoupon:function(t){var e=this,a={};if(a.data=Object(m["a"])({},this.tempData),a.data.due_date=Date.parse(this.tempData.due_date_string)/1e3,"addCoupon"===t){var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/coupon");this.$http.post(o,a).then((function(t){t.data.success?(e.$emit("getCouponsData"),q()("優惠券建立成功！"),e.closeModal()):(q()("優惠券建立失敗！"),e.closeModal())})).catch((function(t){console.dir(t)}))}else if("editCoupon"===t){var n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/coupon/").concat(this.tempData.id);this.$http.put(n,a).then((function(t){t.data.success?(e.$emit("getCouponsData"),q()("優惠券修改成功！"),e.closeModal()):(q()("優惠券修改失敗！"),e.closeModal())})).catch((function(t){console.dir(t)}))}}},mounted:function(){this.couponModal=new A["a"](this.$refs.modal,{backdrop:"static",keyboard:!1})}};S.render=L;var I=S,J=a("ec05"),R=a("1799"),T={data:function(){return{coupons:[],pagination:{},getCouponLoading:!0}},components:{couponModal:I,deleteModal:J["a"],pagination:R["a"]},methods:{getCouponData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;document.documentElement.scrollTop=0,this.getCouponLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/coupons?page=").concat(e);this.$http.get(a).then((function(e){e.data.success&&(t.coupons=e.data.coupons,t.pagination=e.data.pagination,t.getCouponLoading=!1)})).catch((function(t){console.dir(t)}))},openModal:function(t,e){"addCoupon"===t?(this.$refs.couponModal.openModal(),this.$refs.couponModal.modal=t):"editCoupon"===t?(this.$refs.couponModal.openModal(),this.$refs.couponModal.modal=t,this.$refs.couponModal.tempData=Object(m["a"])({},e)):"deleteCoupon"===t&&(this.$refs.deleteModal.openModal(),this.$refs.deleteModal.deleteCouponData=Object(m["a"])({},e))},changeStatus:function(t,e){var a=this;this.getCouponLoading=!0;var o={};o.data=Object(m["a"])({},e),o.data.is_enabled=t?0:1;var n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/coupon/").concat(e.id);this.$http.put(n,o).then((function(t){t.data.success?(a.getCouponData(a.pagination.current_page),q()("優惠券啟用狀態更改為".concat(o.data.is_enabled?"啟用":"不啟用","！"))):q()("優惠券啟用狀態更改失敗！")})).catch((function(t){console.dir(t)}))}},created:function(){this.getCouponData()}};T.render=p;e["default"]=T}}]);
//# sourceMappingURL=chunk-2d20fccc.2831a928.js.map