(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5901f207"],{5651:function(t,e,a){"use strict";a.r(e);a("b0c0");var o=a("7a23"),c={class:"py-4"},n=Object(o["g"])("h2",{class:"text-center"},"訂單管理",-1),d={class:"table table-hover"},r=Object(o["g"])("thead",null,[Object(o["g"])("tr",null,[Object(o["g"])("th",{width:"10%"},"日期"),Object(o["g"])("th",{width:"10%"},"姓名、電話"),Object(o["g"])("th",{width:"30%"},"email、地址"),Object(o["g"])("th",{width:"10%"},"總金額"),Object(o["g"])("th",{width:"10%"},"是否付款"),Object(o["g"])("th",{width:"20%"},"操作")])],-1),s=Object(o["g"])("br",null,null,-1),l=Object(o["g"])("span",{class:"btnInside"},null,-1),i={class:"isEnabled"},b={key:0,class:"loading"},u=Object(o["g"])("div",{class:"loadIcon spinner-border",role:"status"},[Object(o["g"])("span",{class:"visually-hidden"},"Loading...")],-1);function g(t,e,a,g,O,h){var p=Object(o["x"])("pagination"),j=Object(o["x"])("orderProductModal"),f=Object(o["x"])("changeStatusModal"),M=Object(o["x"])("deleteModal");return Object(o["s"])(),Object(o["d"])(o["a"],null,[Object(o["g"])("div",c,[n,Object(o["g"])("table",d,[r,Object(o["g"])("tbody",null,[(Object(o["s"])(!0),Object(o["d"])(o["a"],null,Object(o["w"])(O.orders,(function(t,e){return Object(o["s"])(),Object(o["d"])("tr",{class:"align-middle",key:t.id},[Object(o["g"])("td",null,Object(o["A"])(t.date),1),Object(o["g"])("td",null,[Object(o["f"])(Object(o["A"])(t.user.name),1),s,Object(o["f"])(" "+Object(o["A"])(t.user.tel),1)]),Object(o["g"])("td",null,[Object(o["g"])("p",{class:"mb-0",title:t.user.email},Object(o["A"])(t.user.email),9,["title"]),Object(o["g"])("p",{class:"mb-0",title:t.user.address},Object(o["A"])(t.user.address),9,["title"])]),Object(o["g"])("td",null,Object(o["A"])(t.total),1),Object(o["g"])("td",null,[Object(o["g"])("input",{type:"checkbox",class:"checkbox",id:t.id,checked:t.is_paid,disabled:""},null,8,["id","checked"]),Object(o["g"])("label",{for:t.id,class:"btnWrap",onClick:function(t){return h.openModal("changeStatusModal",e)}},[l],8,["for","onClick"]),Object(o["g"])("span",i,Object(o["A"])(t.is_paid?"已付款":"未付款"),1)]),Object(o["g"])("td",null,[Object(o["g"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(t){return h.openModal("productModal",e)}}," 查看訂單產品",8,["onClick"]),Object(o["g"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return h.openModal("deleteModal",e)}}," 刪除",8,["onClick"])])])})),128))])]),Object(o["g"])(p,{paginationData:O.pagination,onGetData:h.getOrdersData},null,8,["paginationData","onGetData"])]),O.getOedersLoading?(Object(o["s"])(),Object(o["d"])("div",b,[u])):Object(o["e"])("",!0),Object(o["g"])(j,{ref:"productModal"},null,512),Object(o["g"])(f,{ref:"changeStatusModal",onGetOrders:h.getOrdersData},null,8,["onGetOrders"]),Object(o["g"])(M,{ref:"deleteModal",onGetOrder:h.getOrdersData},null,8,["onGetOrder"])],64)}a("99af"),a("159b"),a("fb6a"),a("b64b");var O={class:"modal fade",ref:"submitModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},h={class:"modal-dialog modal-dialog-scrollable"},p={class:"modal-content"},j={class:"modal-header bg-dark"},f=Object(o["g"])("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訂單產品",-1),M={class:"modal-body"},m={class:"modal-footer"};function v(t,e,a,c,n,d){return Object(o["s"])(),Object(o["d"])("div",O,[Object(o["g"])("div",h,[Object(o["g"])("div",p,[Object(o["g"])("div",j,[f,Object(o["g"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return d.closeModal&&d.closeModal.apply(d,arguments)})})]),Object(o["g"])("div",M,[(Object(o["s"])(!0),Object(o["d"])(o["a"],null,Object(o["w"])(n.products,(function(t){return Object(o["s"])(),Object(o["d"])("p",{key:t.title},Object(o["A"])(t.title)+" x "+Object(o["A"])(t.qty),1)})),128))]),Object(o["g"])("div",m,[Object(o["g"])("button",{type:"button",class:"btn btn-secondary",onClick:e[2]||(e[2]=function(){return d.closeModal&&d.closeModal.apply(d,arguments)})},"取消")])])])],512)}var y=a("7b17"),k={data:function(){return{orderProductModal:{},order:{},products:[]}},methods:{openModal:function(){this.orderProductModal.show(),this.getProducts()},closeModal:function(){this.order={},this.products=[],this.orderProductModal.hide()},getProducts:function(){var t=this;this.order.cartIds.forEach((function(e){var a={};a.title=t.order.products[e].product.title,a.qty=t.order.products[e].qty,t.products.push(a)}))}},mounted:function(){this.orderProductModal=new y["a"](this.$refs.submitModal,{backdrop:"static",keyboard:!1})}};k.render=v;var w=k,S={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},x={class:"modal-dialog"},A={class:"modal-content"},C={class:"modal-header bg-dark"},D=Object(o["g"])("h5",{class:"modal-title text-white"},"訂單狀態確認",-1),$={class:"modal-body"},L={key:0},P={key:1},_={class:"modal-footer"};function G(t,e,a,c,n,d){return Object(o["s"])(),Object(o["d"])("div",S,[Object(o["g"])("div",x,[Object(o["g"])("div",A,[Object(o["g"])("div",C,[D,Object(o["g"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return d.closeModal&&d.closeModal.apply(d,arguments)})})]),Object(o["g"])("div",$,[n.order.is_paid?(Object(o["s"])(),Object(o["d"])("p",P,"確定要將訂單狀態更改成未付款？")):(Object(o["s"])(),Object(o["d"])("p",L,"確定要將訂單狀態更改成已付款？"))]),Object(o["g"])("div",_,[Object(o["g"])("button",{type:"button",class:"btn btn-secondary",onClick:e[2]||(e[2]=function(){return d.closeModal&&d.closeModal.apply(d,arguments)})},"取消"),Object(o["g"])("button",{type:"button",class:"btn btn-danger",onClick:e[3]||(e[3]=function(){return d.changeStatus&&d.changeStatus.apply(d,arguments)})},"確認")])])])],512)}var I=a("5530"),E=a("1940"),J=a.n(E),q={data:function(){return{changeStatusModal:{},order:{},page:""}},methods:{openModal:function(){this.changeStatusModal.show()},closeModal:function(){this.order={},this.changeStatusModal.hide()},changeStatus:function(){var t=this,e={};e.data=Object(I["a"])({},this.order),e.data.is_paid=!e.data.is_paid;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/order/").concat(this.order.id);this.$http.put(a,e).then((function(e){e.data.success?(J()("更改訂單付款狀態成功！"),t.closeModal(),t.$emit("getOrders",t.page)):(J()("該改訂單付款狀態失敗！"),t.closeModal())})).catch((function(t){console.dir(t)}))}},mounted:function(){this.changeStatusModal=new y["a"](this.$refs.modal,{backdrop:"static",keyboard:!1})}};q.render=G;var F=q,N=a("ec05"),T=a("1799"),W={data:function(){return{orders:[],originOrders:[],pagination:{},getOedersLoading:!0}},components:{orderProductModal:w,changeStatusModal:F,deleteModal:N["a"],pagination:T["a"]},methods:{getOrdersData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.getOedersLoading=!0,document.documentElement.scrollTop=0;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/orders?page=").concat(e);this.$http.get(a).then((function(e){e.data.success&&(t.orders=JSON.parse(JSON.stringify(e.data.orders)),t.originOrders=e.data.orders,t.pagination=e.data.pagination,t.orders.forEach((function(e,a){var o=new Date(1e3*e.create_at);t.orders[a].date="".concat(o.getFullYear(),"/").concat((0+String(o.getMonth()+1)).slice(-2),"/").concat(o.getDate());var c=Object.keys(e.products);t.orders[a].cartIds=c})),t.getOedersLoading=!1)})).catch((function(t){console.dir(t)}))},openModal:function(t,e){"productModal"===t?this.$refs.productModal.order=this.orders[e]:"changeStatusModal"===t?(this.$refs.changeStatusModal.order=this.originOrders[e],this.$refs.changeStatusModal.page=this.pagination.current_page):"deleteModal"===t&&(this.$refs.deleteModal.deleteStatus=t,this.$refs.deleteModal.deleteOrderId=this.orders[e].id),this.$refs[t].openModal()}},created:function(){this.getOrdersData()}};W.render=g;e["default"]=W},b0c0:function(t,e,a){var o=a("83ab"),c=a("9bf2").f,n=Function.prototype,d=n.toString,r=/^\s*function ([^ (]*)/,s="name";o&&!(s in n)&&c(n,s,{configurable:!0,get:function(){try{return d.call(this).match(r)[1]}catch(t){return""}}})},fb6a:function(t,e,a){"use strict";var o=a("23e7"),c=a("861d"),n=a("e8b5"),d=a("23cb"),r=a("50c4"),s=a("fc6a"),l=a("8418"),i=a("b622"),b=a("1dde"),u=b("slice"),g=i("species"),O=[].slice,h=Math.max;o({target:"Array",proto:!0,forced:!u},{slice:function(t,e){var a,o,i,b=s(this),u=r(b.length),p=d(t,u),j=d(void 0===e?u:e,u);if(n(b)&&(a=b.constructor,"function"!=typeof a||a!==Array&&!n(a.prototype)?c(a)&&(a=a[g],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return O.call(b,p,j);for(o=new(void 0===a?Array:a)(h(j-p,0)),i=0;p<j;p++,i++)p in b&&l(o,i,b[p]);return o.length=i,o}})}}]);
//# sourceMappingURL=chunk-5901f207.2e27028b.js.map