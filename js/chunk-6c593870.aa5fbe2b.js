(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c593870"],{a434:function(t,e,a){"use strict";var c=a("23e7"),l=a("23cb"),o=a("a691"),i=a("50c4"),s=a("7b0b"),n=a("65f0"),d=a("8418"),r=a("1dde"),u=r("splice"),p=Math.max,b=Math.min,m=9007199254740991,g="Maximum allowed length exceeded";c({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var a,c,r,u,h,f,j=s(this),O=i(j.length),v=l(t,O),y=arguments.length;if(0===y?a=c=0:1===y?(a=0,c=O-v):(a=y-2,c=b(p(o(e),0),O-v)),O+a-c>m)throw TypeError(g);for(r=n(j,c),u=0;u<c;u++)h=v+u,h in j&&d(r,u,j[h]);if(r.length=c,a<c){for(u=v;u<O-c;u++)h=u+c,f=u+a,h in j?j[f]=j[h]:delete j[f];for(u=O;u>O-c+a;u--)delete j[u-1]}else if(a>c)for(u=O-c;u>v;u--)h=u+c-1,f=u+a-1,h in j?j[f]=j[h]:delete j[f];for(u=0;u<a;u++)j[u+v]=arguments[u+2];return j.length=O-c+a,r}})},e01a:function(t,e,a){"use strict";var c=a("23e7"),l=a("83ab"),o=a("da84"),i=a("5135"),s=a("861d"),n=a("9bf2").f,d=a("e893"),r=o.Symbol;if(l&&"function"==typeof r&&(!("description"in r.prototype)||void 0!==r().description)){var u={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new r(t):void 0===t?r():r(t);return""===t&&(u[e]=!0),e};d(p,r);var b=p.prototype=r.prototype;b.constructor=p;var m=b.toString,g="Symbol(test)"==String(r("test")),h=/^Symbol\((.*)\)[^)]+$/;n(b,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=m.call(t);if(i(u,t))return"";var a=g?e.slice(7,-1):e.replace(h,"$1");return""===a?void 0:a}}),c({global:!0,forced:!0},{Symbol:p})}},f4fc:function(t,e,a){"use strict";a.r(e);var c=a("7a23"),l={class:"py-4"},o=Object(c["g"])("h2",{class:"text-center"},"商品管理",-1),i={class:"d-flex justify-content-end"},s={class:"table table-hover"},n=Object(c["g"])("thead",null,[Object(c["g"])("tr",null,[Object(c["g"])("th",{width:"25%"},"商品名稱"),Object(c["g"])("th",{width:"15%"},"商品分類"),Object(c["g"])("th",{width:"15%"},"原價"),Object(c["g"])("th",{width:"15%"},"售價"),Object(c["g"])("th",{width:"15%"},"是否啟用"),Object(c["g"])("th",{width:"15%"},"編輯")])],-1),d=Object(c["g"])("span",{class:"btnInside"},null,-1),r={class:"isEnabled"},u={key:0,class:"loading"},p=Object(c["g"])("div",{class:"loadIcon spinner-border",role:"status"},[Object(c["g"])("span",{class:"visually-hidden"},"Loading...")],-1);function b(t,e,a,b,m,g){var h=Object(c["x"])("pagination"),f=Object(c["x"])("productModal"),j=Object(c["x"])("deleteModal");return Object(c["s"])(),Object(c["d"])(c["a"],null,[Object(c["g"])("div",l,[o,Object(c["g"])("div",i,[Object(c["g"])("button",{type:"button",class:"btn btn-primary mb-3",onClick:e[1]||(e[1]=function(t){return g.openModal("addProduct")})},"建立新商品")]),Object(c["g"])("table",s,[n,Object(c["g"])("tbody",null,[(Object(c["s"])(!0),Object(c["d"])(c["a"],null,Object(c["w"])(m.products,(function(t,e){return Object(c["s"])(),Object(c["d"])("tr",{class:"align-middle",key:t.id},[Object(c["g"])("td",null,Object(c["A"])(t.title),1),Object(c["g"])("td",null,Object(c["A"])(t.category),1),Object(c["g"])("td",null,Object(c["A"])(t.origin_price),1),Object(c["g"])("td",null,Object(c["A"])(t.price),1),Object(c["g"])("td",null,[Object(c["g"])("input",{type:"checkbox",class:"checkbox",id:t.id,onChange:function(a){return g.changeStatus(t.is_enabled,e)},checked:1===t.is_enabled},null,40,["id","onChange","checked"]),Object(c["g"])("label",{for:t.id,class:"btnWrap"},[d],8,["for"]),Object(c["g"])("span",r,Object(c["A"])(1===t.is_enabled?"啟用":"不啟用"),1)]),Object(c["g"])("td",null,[Object(c["g"])("button",{type:"button",class:"btn btn-primary me-2",onClick:function(t){return g.openModal("editProduct",e)}},"編輯",8,["onClick"]),Object(c["g"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(e){return g.deleteProduct(t)}}," 刪除",8,["onClick"])])])})),128))])]),Object(c["g"])(h,{paginationData:m.paginationData,onGetData:g.getProductsData},null,8,["paginationData","onGetData"])]),m.getProductsLoading?(Object(c["s"])(),Object(c["d"])("div",u,[p])):Object(c["e"])("",!0),Object(c["g"])(f,{ref:"productModal",onGetProducts:g.getProductsData},null,8,["onGetProducts"]),Object(c["g"])(j,{ref:"deleteModal",onGetProducts:g.getProductsData},null,8,["onGetProducts"])],64)}var m=a("5530"),g=(a("99af"),a("a4d3"),a("e01a"),a("159b"),a("1940")),h=a.n(g),f={ref:"modal",class:"modal fade",tabindex:"-1"},j={class:"modal-dialog productModal"},O={class:"modal-content"},v={class:"modal-header bg-dark text-white"},y={key:0,class:"modal-title"},D={key:1,class:"modal-title"},U={class:"modal-body row"},M={class:"col-6"},k={class:"formGroup mb-3"},w=Object(c["g"])("label",{for:"title",class:"form-label"},"商品名稱",-1),I={class:"formGroup mb-3"},P=Object(c["g"])("label",{for:"category",class:"form-label"},"商品分類",-1),x=Object(c["g"])("option",{value:"",selected:"",disabled:""},"請選擇分類",-1),$=Object(c["g"])("option",{value:"蛋糕"},"蛋糕",-1),_=Object(c["g"])("option",{value:"餅乾"},"餅乾",-1),F=Object(c["g"])("option",{value:"泡芙"},"泡芙",-1),V=Object(c["g"])("option",{value:"其他"},"其他",-1),C={class:"formGroup mb-3"},G=Object(c["g"])("label",{for:"imageUrl",class:"form-label"},"商品主圖",-1),S={key:1,class:"d-flex justify-content-between"},A={class:"btnArea"},N={class:"formGroup mb-3"},E=Object(c["g"])("label",{for:"description",class:"form-label"},"商品描述",-1),z={class:"priceArea mb-3"},L={class:"formGroup"},q=Object(c["g"])("label",{for:"origin_price",class:"form-label"},"原價",-1),J={class:"formGroup"},R=Object(c["g"])("label",{for:"price",class:"form-label"},"售價",-1),T={class:"formGroup"},B=Object(c["g"])("label",{for:"unit",class:"form-label"},"單位",-1),W={key:0,class:"formGroup mb-3"},H=Object(c["g"])("label",{class:"form-label"},"副圖網址",-1),K={class:"formGroup mb-3"},Q={key:1,class:"formGroup mb-3"},X=Object(c["g"])("label",{for:"is_enabled"},"是否啟用",-1),Y={class:"col-6"},Z={class:"px-2"},tt=Object(c["g"])("h2",{class:"text-center"},"主圖預覽",-1),et={class:"previewPicture"},at=Object(c["g"])("h2",{class:"text-center"},"副圖預覽",-1),ct={class:"previewPicture row"},lt={class:"modal-footer"},ot={key:0,type:"submit",class:"btn btn-primary"},it={key:1,type:"submit",class:"btn btn-primary"};function st(t,e,a,l,o,i){var s=Object(c["x"])("Field"),n=Object(c["x"])("ErrorMessage"),d=Object(c["x"])("Form");return Object(c["s"])(),Object(c["d"])("div",f,[Object(c["g"])("div",j,[Object(c["g"])("div",O,[Object(c["g"])(d,{onSubmit:e[15]||(e[15]=function(t){return i.postProduct(o.modal)}),key:o.clearForm},{default:Object(c["F"])((function(t){var a=t.errors;return[Object(c["g"])("div",v,["addProduct"===o.modal?(Object(c["s"])(),Object(c["d"])("h5",y,"商品建立")):(Object(c["s"])(),Object(c["d"])("h5",D,"商品編輯")),Object(c["g"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return i.closeModal&&i.closeModal.apply(i,arguments)})})]),Object(c["g"])("div",U,[Object(c["g"])("div",M,[Object(c["g"])("div",k,[w,Object(c["g"])(s,{type:"text",class:["form-control",{"is-invalid":a["商品名稱"]}],id:"title",name:"商品名稱",placeholder:"請輸入商品名稱",rules:"required",modelValue:o.tempData.title,"onUpdate:modelValue":e[2]||(e[2]=function(t){return o.tempData.title=t})},null,8,["class","modelValue"]),Object(c["g"])(n,{name:"商品名稱",class:"invalid-feedback"})]),Object(c["g"])("div",I,[P,Object(c["g"])(s,{id:"category",class:["form-control",{"is-invalid":a["商品分類"]}],name:"商品分類",rules:"required",as:"select",modelValue:o.tempData.category,"onUpdate:modelValue":e[3]||(e[3]=function(t){return o.tempData.category=t})},{default:Object(c["F"])((function(){return[x,$,_,F,V]})),_:2},1032,["class","modelValue"]),Object(c["g"])(n,{name:"商品分類",class:"invalid-feedback"})]),Object(c["g"])("div",C,[G,o.isUploadImg?(Object(c["s"])(),Object(c["d"])("div",S,[Object(c["g"])(s,{type:"file",name:"file",class:"upImage",id:"upImage",onChange:i.getFile},null,8,["onChange"]),Object(c["g"])("div",A,[Object(c["g"])("button",{type:"button",class:"btn btn-primary btn-sm mb-1 me-2",disabled:!o.imgFiles,onClick:e[5]||(e[5]=function(){return i.uploadImg&&i.uploadImg.apply(i,arguments)})},"上傳圖片",8,["disabled"]),Object(c["g"])("button",{type:"button",class:"btn btn-secondary btn-sm mb-1",onClick:e[6]||(e[6]=function(){return i.changeIsUploadImg&&i.changeIsUploadImg.apply(i,arguments)})},"取消")])])):(Object(c["s"])(),Object(c["d"])("button",{key:0,type:"button",class:"btn btn-primary isUploadImageBtn",onClick:e[4]||(e[4]=function(){return i.changeIsUploadImg&&i.changeIsUploadImg.apply(i,arguments)})},"上傳圖片 ")),Object(c["g"])(s,{type:"url",id:"imageUrl",class:["form-control",{"is-invalid":a["圖片網址"]}],name:"圖片網址",placeholder:"請輸入圖片網址或上傳圖片",rules:i.isUrl,disabled:o.isUploadImg,modelValue:o.tempData.imageUrl,"onUpdate:modelValue":e[7]||(e[7]=function(t){return o.tempData.imageUrl=t})},null,8,["class","rules","disabled","modelValue"]),Object(c["g"])(n,{name:"圖片網址",class:"invalid-feedback"})]),Object(c["g"])("div",N,[E,Object(c["g"])(s,{type:"text",class:["form-control",{"is-invalid":a["商品描述"]}],id:"description",name:"商品描述",placeholder:"請輸入商品描述",as:"textarea",rules:"required",modelValue:o.tempData.description,"onUpdate:modelValue":e[8]||(e[8]=function(t){return o.tempData.description=t})},null,8,["class","modelValue"]),Object(c["g"])(n,{name:"商品描述",class:"invalid-feedback"})]),Object(c["g"])("div",z,[Object(c["g"])("div",L,[q,Object(c["g"])(s,{type:"number",class:["form-control",{"is-invalid":a["原價"]}],id:"origin_price",name:"原價",placeholder:"請輸入原價",min:"0",rules:"required|min_value:0",modelValue:o.tempData.origin_price,"onUpdate:modelValue":e[9]||(e[9]=function(t){return o.tempData.origin_price=t}),modelModifiers:{number:!0}},null,8,["class","modelValue"]),Object(c["g"])(n,{name:"原價",class:"invalid-feedback"})]),Object(c["g"])("div",J,[R,Object(c["g"])(s,{type:"number",class:["form-control",{"is-invalid":a["售價"]}],id:"price",name:"售價",placeholder:"請輸入售價",rules:i.priceRule,min:"0",modelValue:o.tempData.price,"onUpdate:modelValue":e[10]||(e[10]=function(t){return o.tempData.price=t}),modelModifiers:{number:!0}},null,8,["class","rules","modelValue"]),Object(c["g"])(n,{name:"售價",class:"invalid-feedback"})]),Object(c["g"])("div",T,[B,Object(c["g"])(s,{type:"text",class:["form-control",{"is-invalid":a["單位"]}],id:"unit",name:"單位",placeholder:"請輸入單位(如：個)",rules:"required",modelValue:o.tempData.unit,"onUpdate:modelValue":e[11]||(e[11]=function(t){return o.tempData.unit=t})},null,8,["class","modelValue"]),Object(c["g"])(n,{name:"單位",class:"invalid-feedback"})])]),0!==o.tempData.imagesUrl.length?(Object(c["s"])(),Object(c["d"])("div",W,[H,(Object(c["s"])(!0),Object(c["d"])(c["a"],null,Object(c["w"])(o.tempData.imagesUrl,(function(t,e){return Object(c["s"])(),Object(c["d"])("div",{class:"d-flex justify-content-between flex-wrap mb-3",key:e},[Object(c["g"])(s,{type:"url",class:["form-control imagesUrlArea",{"is-invalid":a[o.imagesFieldName[e]]}],name:o.imagesFieldName[e],placeholder:o.imagesFieldName[e],rules:i.isImagesUrl,modelValue:o.tempData.imagesUrl[e],"onUpdate:modelValue":function(t){return o.tempData.imagesUrl[e]=t}},null,8,["class","name","placeholder","rules","modelValue","onUpdate:modelValue"]),Object(c["g"])("button",{type:"button",class:"btn btn-danger",onClick:function(t){return i.deleteImage(e)}},"刪除",8,["onClick"]),Object(c["g"])(n,{name:o.imagesFieldName[e],class:"invalid-feedback"},null,8,["name"])])})),128))])):Object(c["e"])("",!0),Object(c["g"])("div",K,[Object(c["g"])("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=function(){return i.addImages&&i.addImages.apply(i,arguments)}),disabled:""===o.tempData.imagesUrl[o.tempData.imagesUrl.length-1]},"增加副圖",8,["disabled"])]),"addProduct"===o.modal?(Object(c["s"])(),Object(c["d"])("div",Q,[Object(c["g"])("input",{type:"checkbox",id:"is_enabled",name:"is_enabled",onChange:e[13]||(e[13]=function(){return i.isEnabled&&i.isEnabled.apply(i,arguments)})},null,32),X])):Object(c["e"])("",!0)]),Object(c["g"])("div",Y,[Object(c["g"])("div",Z,[tt,Object(c["g"])("div",et,[Object(c["g"])("img",{class:"w-100",src:o.tempData.imageUrl,alt:"圖片預覽"},null,8,["src"])]),at,Object(c["g"])("div",ct,[(Object(c["s"])(!0),Object(c["d"])(c["a"],null,Object(c["w"])(o.tempData.imagesUrl,(function(t){return Object(c["s"])(),Object(c["d"])("img",{class:"col-4",src:t,alt:"圖片預覽",key:t},null,8,["src"])})),128))])])])]),Object(c["g"])("div",lt,[Object(c["g"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[14]||(e[14]=function(){return i.closeModal&&i.closeModal.apply(i,arguments)})},"取消"),"addProduct"===o.modal?(Object(c["s"])(),Object(c["d"])("button",ot,"建立")):(Object(c["s"])(),Object(c["d"])("button",it,"編輯"))])]})),_:1})])])],512)}a("a434");var nt=a("7b17"),dt={data:function(){return{productModal:{},modal:"",tempData:{title:"",category:"",imageUrl:"",description:"",origin_price:"",price:"",unit:"",is_enabled:0,imagesUrl:[]},isUploadImg:!1,imgFiles:"",clearForm:!1,editId:"",imagesFieldName:[]}},methods:{openModal:function(){this.productModal.show(),this.clearForm=!1},closeModal:function(){this.productModal.hide(),this.clearForm=!0,this.clearData()},clearData:function(){this.tempData.title="",this.tempData.category="",this.tempData.imageUrl="",this.tempData.description="",this.tempData.origin_price="",this.tempData.price="",this.tempData.unit="",this.tempData.imagesUrl=[],this.tempData.is_enabled=0,this.editId="",this.imagesFieldName=[]},isUrl:function(t){var e=/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;return this.tempData.imageUrl?!!e.test(t)||"圖片網址 格式不正確":"圖片網址 為必填欄位"},isImagesUrl:function(t){var e=/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;return""===t?"副圖網址沒有內容，如不輸入網址，請先刪除欄位！":!!e.test(t)||"副圖網址 格式不正確"},priceRule:function(t){return t?!(t>this.tempData.origin_price)||"售價 必須小於或等於原價":"售價 為必填欄位"},changeIsUploadImg:function(){this.imgFiles="",this.isUploadImg=!this.isUploadImg},getFile:function(t){this.imgFiles=t.target.files},uploadImg:function(){var t=this,e=new FormData;e.append("file-to-upload",this.imgFiles[0]);var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/upload");this.$http.post(a,e).then((function(e){e.data.success?(t.tempData.imageUrl=e.data.imageUrl,t.changeIsUploadImg(),h()("圖片上傳成功！")):h()("圖片上傳失敗！")})).catch((function(t){console.dir(t)}))},isEnabled:function(){0===this.tempData.is_enabled?this.tempData.is_enabled=1:this.tempData.is_enabled=0},addImages:function(){this.tempData.imagesUrl.push(""),this.imagesFieldName.push("副圖".concat(this.tempData.imagesUrl.length,"網址"))},deleteImage:function(t){this.tempData.imagesUrl.splice(t,1),this.imagesFieldName.pop()},postProduct:function(t){var e=this;if("addProduct"===t){var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/product");this.$http.post(a,{data:this.tempData}).then((function(t){t.data.success?(h()("商品建立成功！"),e.closeModal(),e.$emit("getProducts")):h()("商品建立失敗！")})).catch((function(t){console.dir(t)}))}else{var c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/product/").concat(this.editId);this.$http.put(c,{data:this.tempData}).then((function(t){t.data.success?(h()("商品修改成功！"),e.closeModal(),e.$emit("getProducts")):h()("商品修改失敗！")})).catch((function(t){console.dir(t)}))}}},mounted:function(){this.productModal=new nt["a"](this.$refs.modal,{backdrop:"static",keyboard:!1})}};dt.render=st;var rt=dt,ut=a("ec05"),pt=a("1799"),bt={data:function(){return{products:[],tempData:{},getProductsLoading:!0,paginationData:""}},components:{productModal:rt,deleteModal:ut["a"],pagination:pt["a"]},methods:{getProductsData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;document.documentElement.scrollTop=0,this.getProductsLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/products?page=").concat(e);this.$http.get(a).then((function(e){e.data.success&&(console.log(e.data),t.products=e.data.products,t.paginationData=e.data.pagination,t.getProductsLoading=!1)})).catch((function(t){console.dir(t)}))},changeStatus:function(t,e){var a=this;this.getProductsLoading=!0;var c=0;c=1===t?0:1,this.tempData=this.products[e],this.tempData.is_enabled=c;var l="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/product/").concat(this.tempData.id);this.$http.put(l,{data:this.tempData}).then((function(t){t.data.success?(h()("將狀態更新為".concat(1===c?"啟用":"不啟用","！")),a.getProductsData()):h()("更新產品狀態失敗！")})).catch((function(t){console.dir(t)}))},openModal:function(t,e){var a=this;"editProduct"===t&&(this.$refs.productModal.tempData.title=this.products[e].title,this.$refs.productModal.tempData.category=this.products[e].category,this.$refs.productModal.tempData.imageUrl=this.products[e].imageUrl,this.$refs.productModal.tempData.description=this.products[e].description,this.$refs.productModal.tempData.origin_price=this.products[e].origin_price,this.$refs.productModal.tempData.price=this.products[e].price,this.$refs.productModal.tempData.unit=this.products[e].unit,this.$refs.productModal.tempData.is_enabled=this.products[e].is_enabled,this.$refs.productModal.editId=this.products[e].id,void 0!==this.products[e].imagesUrl&&this.products[e].imagesUrl.forEach((function(t,e){a.$refs.productModal.tempData.imagesUrl.push(t),a.$refs.productModal.imagesFieldName.push("副圖".concat(e+1,"網址"))}))),this.$refs.productModal.modal=t,this.$refs.productModal.openModal()},deleteProduct:function(t){this.$refs.deleteModal.openModal(),this.$refs.deleteModal.deleteStatus="deleteProduct",this.$refs.deleteModal.deleteProduct=Object(m["a"])({},t)}},mounted:function(){this.getProductsData()}};bt.render=b;e["default"]=bt}}]);
//# sourceMappingURL=chunk-6c593870.aa5fbe2b.js.map